=====================
 自动升级程序 说明
=====================

自动升级程序为单独程序，由宿主程序调用，调用格式为：

AutoUpgrader.exe ScriptURL CurVersion SoftName WinHandle ExitMsgID ProcessID

参数说明:
  ScriptURL   - 升级脚本文件的URL
  CurVersion  - 宿主程序的当前版本号
  SoftName    - 宿主程序的软件名称
  WinHandle   - 宿主程序用来接收消息的窗口句柄
  ExitMsgID   - 宿主程序收到此消息后应退出程序
  ProcessID   - 宿主程序的进程ID (GetCurrentProcessID)

软件特性:
  ◎ 升级动作完全由脚本定制；
  ◎ 升级动作支持: 替换、增加、删除和执行；
  ◎ 支持自升级(即对升级程序自身进行升级)；
  ◎ 独立于宿主程序，无源码耦合；

工作原理:
    升级程序从服务器下载脚本文件，此文件中记载着最高版本号，经比较后，
可得知是否需要升级。然后弹出对话框，询问用户是否升级。若是，则按照升
级脚本中指定的地址下载新版本软件，并存放在本地特定目录下。下载完成后，
先让宿主程序退出，再将新文件覆盖旧文件。
    若须自升级，则在升级程序退出时，生成临时批处理(bat)文件，EXE的自
删除和覆盖由批处理文件进行。

宿主程序的工作:
  1. 指定一个窗口(一般为主窗口)，用来接收升级程序发来的消息。在此窗口
中接管“退出消息”，此消息ID由宿主程序定义(如 MW_USER + 500)。宿主程
序在收到此消息后，应尽快退出。
  2. 在合适的地方调用升级程序。调用时应注意命令行参数。各参数含义详见
上文。


